<html><head><title>部件檢索</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/material-design-iconic-font@2.2.0/dist/css/material-design-iconic-font.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.bundle.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/@iconfu/svg-inject@1.2.3/dist/svg-inject.min.js" defer></script>
<script src="http://www.mebag.com/index/js/bootstrap-select/1.13.2/js/i18n/defaults-zh-Hant.min.js" defer></script>
<script src="http://www.mebag.com/index/js/router.js?v=2" defer></script>
</head><body style="padding: 1.5% 7%">

<!----------------------------------------------------------------------------->
<!-- 客製化修改區起始 -->
<!----------------------------------------------------------------------------->
<style>
.hidden{display:none !important;}
.Decmp g {fill:#0045FF;}
.Fuzzy g {fill:#404040;}
.Exact g {fill:#FF4500;}
.label-option{text-indent:0;margin-bottom:0;cursor:pointer;}
</style>
<style>
a{text-decoration:none}a:link{color:#1257F9}a:visited{color:#1257F9}a:hover{color:#FF00FF;text-decoration:none}
button:hover{color:#FF00FF}
.Line {font-family:Calibri,FMing-m,FMing-1,FMing-2,FMing-3,FMing-F,FSung-m,FSung-1,FSung-2,FSung-3,FSung-F,MingLiU,MingLiU-ExtB;display:block;}
.Options {margin-left:4em;text-indent:-3em;}
.Title {font-family:DFKai-SB;font-size:1.5em;color:#0000FF;}
.Total {color:#FF0080;}
.LabelB {color:#000088;}
.LabelR {color:#600060;}
.LabelL {color:#0000FF;}
.Editor {font-size:1.2em;font-family:FMing-m,FMing-1,FMing-2,FMing-3,FMing-F,FSung-m,FSung-1,FSung-2,FSung-3,FSung-F,MingLiU,MingLiU-ExtB;}
.Button {width:2em;height:2em;border:1px solid #707070;padding:3px 2px 1px 2px;border-radius:5px;background-color:#E0E0E0;margin-left:0;text-indent:0;cursor:pointer;font-family:Arial;}
.FnKey {font-size:1.2em;width:1.4em;height:1.4em;border:1px solid #FF7070;padding:2px 2px 1px 2px;border-radius:5px;color:#0000FF;background-color:#FFE0E0;margin-left:0;margin-right:1px;text-indent:0;cursor:pointer;font-family:FMing-m,FMing-1,FMing-2,FMing-3,FMing-F,FSung-m,FSung-1,FSung-2,FSung-3,FSung-F,MingLiU,MingLiU-ExtB;}
.Counter {color:#696969;}
.Keypad {line-height:100%;width:100%}
.Cathdr {font-size:0.8em;color:#404040;background-color:#C0C0C0;text-align:center;line-height:100%;}
.Catbdy {background-color:#E0E0E0;vertical-align:top;white-space:nowrap;}
.Key {width:17pt;height:17pt;font-size:12pt;color:#0000FF;background-color:#E0E0E0;border-left:1px solid #FFFFFF;border-top:1px solid #FFFFFF;border-right:1px solid #808080;border-bottom:1px solid #808080;padding:1px 2px 1px 1px;margin:0;cursor:pointer;font-family:FMing-m,FMing-1,FMing-2,FMing-3,FMing-F,FSung-m,FSung-1,FSung-2,FSung-3,FSung-F,MingLiU,MingLiU-ExtB;}
.Legend {line-height:180%;}
.Color {width:1.5em;height:1.5em;border:1px solid #C0C0C0;padding:0px 2px 1px 2px;margin-left:0;text-indent:0;cursor:pointer;font-family:Calibri;}
.BMP {background-color:#E0E0E0;}
.ExA {background:#C0E8FF;}
.ExB {background:#FFF8D0;}
.ExC {background:#D1BADA;}
.ExD {background:#80FFB0;}
.ExE {background:#FFC0D0;}
.ExF {background:#90E0D0;}
.ExG {background:#CBD0FF;}
.CMP {background:#FFFFFF;}
.SUP {background:#FCC800;}
.OTH {background:#808080;}
.Decmp {color:#0045FF!important;}
.Fuzzy {color:#404040!important;}
.Exact {color:#FF4500!important;}
.Output {font-size:1.5em;line-height:150%;}
.Block {border:1px solid #C0C0C0;padding:0px 1px 2px 1px;}
</style>

<!-- UI 畫面區 -->
<div class="Header">
<div id="loading">
<div style="display: flex;align-items: center;">
<span class="Title">部件檢索 - </span>
<div class="d-flex align-items-center"><div class="spinner-grow text-secondary" role="status"></div><strong style="color:#6c757d">字庫加載中，請耐心等待</strong></div>
</div>
</div>
<div id="loaded" class="hidden">
<div style="display: flex;align-items: center;">
<span class="Title">部件檢索 - </span>
<select id="selectpicker" class="selectpicker" data-width="fit" data-size="10" data-live-search="true">
<option value="all">引得市</option>
</select>專用版（<span id="charcount" class="Total"></span>字）
</div>
</div>
<hr color=#C0C0C0>
<span class="Line Options"><span class="LabelB">部件</span>：<input class="Editor" id="input" oninput="FindMatch(0, true)" onkeydown="OnKey(event.keyCode)"></input>
<button class="Button" title="清除按鈕：清除所有的查詢輸入及查詢結果。實體鍵盤的「Esc」鍵有相同作用。" onclick="ClearFind()"><i class="zmdi zmdi-delete"></i></button><button class="Button" title="倒退按鈕：模擬實體鍵盤的「Backspace」鍵。" onclick="Backspace()"><i class="zmdi zmdi-chevron-left"></i></button><button class="Button" title="解構按鈕：將輸入點定在某個已輸入的漢字之後，按下此鍵即可直接解構該漢字，例如「淵」會裂解成「氵𣶒」。" onclick="Decompose()"><i class="zmdi zmdi-scissors"></i></button><button class="Button" title="查詢按鈕：進行查詢檢索，查詢結果的上限為一千字。實體鍵盤的「Enter」鍵有相同作用。" onclick="FindMatch(0, false)"><i class="zmdi zmdi-search"></i></button>
　<e title="快捷鍵暫存區：雙擊查詢結果可將其釘選到快捷鍵暫存區，成為一個自訂的快捷鍵。之後的查詢便可以利用該快捷鍵來輸入，不必每次都清空查詢區，重新查詢。快捷鍵暫存區至多能保存十個最新的查詢結果。">⌘</e> <span id="FnKey"></span></span>
<span class="Line Options"><span class="LabelR">選項</span>：<label class="label-option" title="勾選時會將所有互為異體的部件視為相同；反之則視為不同。"><input type="checkbox" id="variant" onclick="OnVar()">包容異體</label>&nbsp;<label class="label-option" title="勾選時會啟用筆畫層級的細粒度拆分，查詢結果會更多，但可能引起一定的卡頓；反之則只使用常規拆分。"><input type="checkbox" id="subdivide" onclick="OnSdv()">無理拆分</label>&nbsp;<label class="label-option" title="勾選時只查詢Unicode標準字，不查詢補充字；反之則全部查詢。"><input type="checkbox" id="ucodeonly" onclick="OnUco()">限標準字</label>&nbsp;<label class="label-option" title="勾選時輸入框裡有任何輸入變動均會自動執行查詢檢索（為縮短反應時間，查詢結果僅限一百字，但「精確命中」的字一定會列出，不在此限。若要查看百字以外的字，可再多按一下「查詢」按鈕）；反之則需等到按下「查詢」按鈕才會執行查詢檢索。"><input type="checkbox" id="onthefly" onclick="OnFly()">即時查詢</label>&nbsp;<label class="label-option" title="勾選時檢索結果會以較大的字形來顯示；反之則用較小的字形顯示。"><input type="checkbox" id="largefont" onclick="OnFnt()">較大字形</label>&nbsp;<label class="label-option" title="勾選時檢索結果會以圖片來顯示；反之則用文字顯示。"><input type="checkbox" id="glyphmode" onclick="OnGlyph()">圖片模式</label>&nbsp;<label class="label-option" title="勾選時點擊檢索結果會將該漢字複製到剪貼簿；反之則跳轉至引得市資料庫的對應網頁。"><input type="checkbox" id="copymode" onclick="OnCpy()">複製模式</label></span>
<span class="Line Options"><span class="LabelB">字數</span>：<span class="Counter" id="counter"></span></span>
<hr color=#C0C0C0>
</div>
<div class="Keyboard">
<span class="Line"><button class="Color" id="padbtn" title="鍵盤收/展" onclick="OnPad()">▲</button>⌨
<span class="Line" id="keypad"><table class="Keypad">
<tr id="cathdr"></tr><tr id="catbtn"></tr>
</table></span>
</div>
<div class="Content">
<span class="Line Legend"><span class="LabelL">⨠</span> <button class="Color BMP" onclick="Key('@')">　</button> 基本　<button class="Color ExA" onclick="Key('A')">　</button> A區　<button class="Color ExB" onclick="Key('B')">　</button> B區　<button class="Color ExC" onclick="Key('C')">　</button> C區　<button class="Color ExD" onclick="Key('D')">　</button> D區　<button class="Color ExE" onclick="Key('E')">　</button> E區　<button class="Color ExF" onclick="Key('F')">　</button> F區　<button class="Color ExG" onclick="Key('G')">　</button> G區　<button class="Color CMP" onclick="Key('X')">　</button> 相容　<button class="Color SUP" onclick="Key('Y')">　</button> 補充　<button class="Color OTH" onclick="Key('Z')">　</button> 其他　</span>
<span class="Line Output" id="output"><br><br><br><br><br><br><br><br><br><br><br><br></span>
<br>
</div>

<!-- UI 程式區 -->
<script>
var hasModernSet = typeof Set == 'function' && (new Set('0')).size != 0;
var charset = null;
var bookInfo = {};
var largeFont = false;
var glyphMode = false;
var pua = false;
document.addEventListener('DOMContentLoaded', function() {
	router.forEach(function(config) {
		var optgroupHtml = '';
		optgroupHtml +='<optgroup label="'+ config.database +'">';
		config.bookList.sort().forEach(function(book_name) {
			optgroupHtml += '<option>' + book_name + '</option>';
			bookInfo[book_name] = {
				link: config.prefix + book_name + config.suffix,
				pua: config.pua
			};
		});
		optgroupHtml +='</optgroup>';
		$('#selectpicker').append(optgroupHtml);
	});

	$('#charcount').html(dt.length);
	$('#loading').addClass('hidden');
	$('#loaded').removeClass('hidden');
	// selectpicker onchange
	$('#selectpicker').change(function() {
		var book_name;
		if ($('#selectpicker').val() == 'all') {
			book_name = '';
			charset = null;
			pua = false;
			$('#charcount').html(dt.length);
		} else {
			book_name = $('#selectpicker').val();
			$.get('http://c4n4en.coding-pages.com/charset/' + book_name + '.txt', function(data, status) {
				charset = hasModernSet ? new Set(data) : (data || '');
				$('#charcount').html(hasModernSet ? charset.size : getStrLength(charset));
			}, 'text')
			.fail(function() {
				alert('文獻《' + book_name +'》不存在，請聯繫引得市站長添加');
				$('#selectpicker').selectpicker('val', 'all');
				charset = null;
				pua = false;
				$('#charcount').html(dt.length);
				ref = defaultRef;
			});
		}
		if (bookInfo[book_name]) {
			ref = bookInfo[book_name].link;
			pua = bookInfo[book_name].pua;
		} else {
			ref = defaultRef;
			pua = false;
		}
	});
});

function contains(c) {
	if (hasModernSet) {
		return charset.has(c);
	} else {
		return charset.indexOf(c) >= 0;
	}
}

function getStrLength(str) {
	return str.length - (str.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g)||[]).length;
}

function renderLargeFont() {
	largeFont = $('#largefont').is(':checked');
	var size = largeFont ? '2rem' : '1.5rem';
	$('#output img').width(size);
	$('#output img').height(size);
	$('#output svg').width(size);
	$('#output svg').height(size);
}

function renderGlyphMode() {
	glyphMode = $('#glyphmode').is(':checked');
	$('#output a').html(function(){
		var $this = $(this);
		return getText($this.data('c'), $this.data('t'), $this.data('m'));
	});
}

function getText(c, t, m) {
	if (!glyphMode || m < 0) {
		return t;
	}
	switch (GetBlock(c)) {
	case 1:		// 基本
	case 2:		// A區
	case 3:		// B區
	case 4:		// C區
	case 5:		// D區
	case 6:		// E區
	case 7:		// F區
	case 8:		// G區
	case 27:	// 相容
	case 28:
	case 29:	// 相容
		var size = largeFont ? '2rem' : '1.5rem';
		return '<img src="https://glyphwiki.org/glyph/u'+c.toString(16)+'.svg" alt="'+t+'" style="width:'+size+';height:'+size+';" onload="SVGInject(this)"/>';
	case 30:	// 補充
	case 31:
	default:	// 其他
		return t;
	}
}

function registerDownloadImageEvent() {
	$('#output a').on('click', function(e){
		if (e.ctrlKey) {
			e.preventDefault();
			var c = $(this).data('c');
			if (c >= 0xF0000) return;
			downloadImage('https://glyphwiki.org/glyph/u'+c.toString(16)+'.png','u'+c.toString(16));
		}
	});
}

function downloadImage(imgsrc, name) {
	let image = new Image();
	image.setAttribute("crossOrigin", "anonymous");
	image.onload = function() {
		let canvas = document.createElement("canvas");
		canvas.width = image.width;
		canvas.height = image.height;
		let context = canvas.getContext("2d");
		context.drawImage(image, 0, 0, image.width, image.height);
		let url = canvas.toDataURL("image/png");
		let a = document.createElement("a");
		let event = new MouseEvent("click");
		a.download = name || "photo";
		a.href = url;
		a.dispatchEvent(event);
	};
	image.src = imgsrc;
}
</script>
<script>
// 類聚鍵盤的定義，冒號前為分類名稱，逗點代表折行
var kt=[
"筆,畫:一丨丶,㇒丿㇀,㇈亅乚,㇄㇁㇂,𠄌𠃊𠃋,𠃎𠃍󰎀,𡿨乛㇇,㇏乀⺄,𠃌㇆󰋌,㇉𠃑㇊,㇣㐅乂,󰊅󰊸󰕐,𰀪⺀巜",
"字,頭:艹⺾艹䒑𥫗龴,⺈𠆢𠂉󰓶亠𠚤,丷⺌𭕄爫爫,𠂆厂广疒𤕫,厃产󰒖屵严,尸𠃜󰓏耂𠫓󶅠,罒㓁罓龷𠀎,覀⺜龶⺻󰋐,冖⺳宀龸󰒑󰓔,𤇾𫇦󰋚󰓐󰒾,󰊟癶󰒛龹𡗗,⻗󰋍𦥯𰃮龻,𠂒虍󶃛󰒭𦍌󰓗",
"包,圍:冂⺆,󰒂𠘨,凵𠙴,匚𠥓,匸󰒦,勹𦉶,󰊥󰊶,󰓴󶏔,󰑖󰑹,𢦏󰑷,󰏹㦰,󰐂,囗𦝠",
"計,數:甲乙丙丁,戊己庚辛,壬癸,子丑寅卯,辰巳午未,申酉戌亥,一二三四,五六七,八九十廿,卄卅卌𠦃,万寸尺丈,上丄下丅,大中小𡭔",
"自,然:日月,󰑬夕,風气,雨雲,金釒,木钅,水氵,氺󰐻,火灬,土石,冫仌,天倝",
"地,理:山业,丘巛,川𫶧,穴谷,𣶒󰑉,州,皋𠂤,阜⻖,𨸏阝,邑⻏",
"動,物:鼠牛牜虎,毚㲋龍巴,虫馬羊⺶,⺸𦍋𦫳犭,犬犮豕𧰨,豸鹿𢊁廌,魚鳥隹嘼,黽黾龜貝,彐彑㣇,角羽毛巤,爪󰒬釆禸,习卂飞飛,隺禺󰊎",
"植,物:艸屮屮,木朩本,竹禾𥝌,米𠂭麥,麻黍桼,豆瓜𤓰,朿𣎵󰏶,𣎳𣏟支,丰󰐸丯,韭華𢎘,𠧪𠂹丵",
"人,體:首頁𦣻𡿺囟,髟丱卝㐱彡,冉冄而口亼,舌牙㸦齒𧮫,𦣞𦣝目耳,鼻自面靣身,心忄⺗血骨,肉⺼⺝󰐧皮,手扌龵𠂇䶹,𰀂𰀄又⺕󰐷,𦥑廾󰊓𠬞𠬜,足𧾷疋𤴔止,龰丮𠃨",
"食,飲:食,飠,𩙿,饣,丣,鹵,鬯,甘,香,皀",
"衣,飾:衣𧘇,衤冃,巾巿,糸纟,糹黹,革𮧓,韋韦,玉⺩,文",
"住,居:門,戶,囱,囪,几,舍,囧,瓦,井,爿,丬,田,里",
"行,旅:行走,辵辶,⻌⻍,廴夂,𫝀夊,𡕒㐄,彳𣥂,𤴓夋,舟車,立至,入隶,冘",
"書,樂:聿,𦘒,肀,册,𠕁,史,壴,鼓,龠,音",
"祭,祀:卜,⺊,爻,兆,示,⺬,礻,𥘅,鬼,甶,亯,用,夬",
"器,物:皿酉,缶𦈢,网𦉰,冈𠔿,𦉫𦉪,匕𠁁,斗臼,鬲鼎,丌󰊓,耒𦓤,𠦒甾",
"軍,事:刀刂,力刄,刃刅,斤弋,弓󰓹,干矢,戈戉,矛盾,殳𠘧,卩㔾,攴攵,㫃𭤨,爭鬥",
"人,稱:人亻,󰉼𠂊,乑𫡑,厶公,我爾,父母,儿女,士夫,王臣,氏民,𠦑",
"生,命:生,老,歹,歺,𣦵,亾,𠤎,尢,尣,䇂",
"顏,色:青,靑,白,朱,赤,黑,玄,黃,色",
"動,作:言讠,訁曰,吅从,㕯工,見艮,欠夨,襾󰒊,𡳾𠂈,疌",
"雜,類:長镸长高𠦝肅,丆乁幺乡㇋𠄎,丂𠀁亏亐󰑲〢,𠔼冋冎㒳㡀㒼,兀无旡兂圥󰩮,方𠮠片𰀁𢆉𦍍,毋毌齊齐段叚,㠯比𠃏丩𠂎乇,舛夗非开幵幷,𠂔𪩲巨亞亜戼,東西南北󰔲叀,𢑚𠃬𢏚㢴"
];

// Global 變數
// $CHR$ 表示未經編碼的漢字變數
// $ENC$ 表示經URI編碼的漢字變數
// $UCD$ 表示漢字的10進制Unicode變數
// $UCh$ 表示漢字的16進制小寫Unicode變數
// $UCH$ 表示漢字的16進制大寫Unicode變數
var defaultRef = "http://www.mebag.com/index/main/list.asp?key3=$ENC$&key4=entry";
var ref = defaultRef;
var ime = 0;

// 設定 Cookie
var SetCookie=function(n, v)
{
	if (window.localStorage)
		window.localStorage.setItem(n, v);
	else
		document.cookie = n +"="+ v +"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/";
};

// 讀取 Cookie
var GetCookie=function(n, v)
{
	var s = "";
	if (window.localStorage)
	{
		s = window.localStorage.getItem(n);
		if (!s)
		{
			window.localStorage.setItem(n, v);
			s = v;
		}
	}
	else
	{
		var t = n + "=";
		var a = document.cookie.split(';');
		for (var i=0; i<a.length; i++)
		{
			var p = a[i];
			while (p.charAt(0) == ' ')  p = p.slice(1);
			if (p.indexOf(t) == 0)
			{
				s = p.slice(t.length, p.length);
				break;
			}
		}
		if (s == "")
		{
			SetCookie(n, v);
			s = v;
		}
	}
	return s;
};

// 寫入剪貼簿
var SetClipBoard=function(s)
{
	s = decodeURI(s);
	if (window.clipboardData)
	{
		window.clipboardData.clearData();
		window.clipboardData.setData("Text", s);
	}
	else
	{
		var t = document.createElement("textarea");
		t.textContent = s;
		var body = document.body;
		body.appendChild(t);
		t.select();
		document.execCommand('copy');
		body.removeChild(t);
	}
};

// 取得游標位置
var GetPos=function(e)
{
	e.focus();
	var n = 0;
	n = e.selectionStart;
	return n;
};

// 設定游標位置
var SetPos=function(e, n)
{
	e.setSelectionRange(n, n);
};

// 取得選擇文字
var GetSel=function(e)
{
	return e.value.substring(e.selectionStart, e.selectionEnd);
}

// 清除選擇文字
var DelSel=function(e)
{
	var m = e.selectionStart;
	var n = e.selectionEnd;
	if (m != n)
	{
		e.value = e.value.substring(0, m) + e.value.substring(n);
		e.setSelectionRange(m, m);
	}
}

// 設定功能鍵
var FnKey = [];
var SetFnKey=function(w)
{
	if (FnKey.length > 9)  FnKey.splice(0, 1);
	FnKey.push(w);
	var s = "";
	for (i=0; i<FnKey.length; i++)
		s += "<button class='FnKey' onclick='Key(\""+FnKey[i]+"\")' oncontextmenu='SetClipBoard(\""+FnKey[i]+"\");return false;'>" + FnKey[i] + "</button>";
	document.getElementById("FnKey").innerHTML = s;
};

// 過濾比對字符
// w : Unicode字元
// c : Unicode碼
// z : Unicode碼區 1=基本 2=A區 3=B區 4=C區 5=D區 6=E區 7=F區 8=G區
//                 27,28=相容 29=相容補充 30=補充 0=其他
// 回傳真值表示捨棄此字
var Filter=function(w, c, z)
{
	return !(($('#selectpicker').val() == 'all') || (charset&&contains(w)));
};

// 產生結果方塊
// w : Unicode字元
// c : Unicode碼
// m : 命中狀態 0=精確命中 >0=模糊命中 <0=漢字解構
// a : 執行動作
// t : 顯示文字
// 回傳空字串表示捨棄此字
var MakeBlock=function(w, c, m, a, t)
{
	var f = (m < 0) ? "Decmp" : (m ? "Fuzzy" : "Exact");
	var n = GetBlock(c);
	switch (n)
	{
	case 1:		// 基本
		b = "BMP";
		break;
	case 2:		// A區
		b = "ExA";
		break;
	case 3:		// B區
		b = "ExB";
		break;
	case 4:		// C區
		b = "ExC";
		break;
	case 5:		// D區
		b = "ExD";
		break;
	case 6:		// E區
		b = "ExE";
		break;
	case 7:		// F區
		b = "ExF";
		break;
	case 8:		// G區
		b = "ExG";
		break;
	case 27:	// 相容
	case 28:
		b = "CMP";
		break;
	case 29:	// 相容
		b = "CMP";
		break;
	case 30:	// 補充
		b = "SUP";
		break;
	default:	// 其他
		b = "OTH";
	}

	return ("<a class='Block "+f+" "+b+"' data-c='"+c+"' data-t='"+t+"' data-m='"+m+"' oncontextmenu='ReplaceFind(\""+w+"\");return false;' ondblclick='SetFnKey(\""+w+"\")' "+a+">"+getText(c, t, m)+"</a>");
};

// 部件檢索
var lq;
var FindMatch=function(m, c)
{
	if (ime)  return;
	var e = document.getElementById("input");
	e.focus();
	if (c && !document.getElementById("onthefly").checked)  return;
	var s = GetSel(e);
	if (!s)  s = e.value;
	if (!s)
	{
		document.getElementById("counter").innerHTML = "";
		document.getElementById("output").innerHTML = "<br>";
		lq = s;
		return;
	}
	var d = document.getElementById("subdivide").checked;
	var l = [];
	if (s.charAt(0) == "\\")
		l = GetTree(s.slice(1), d);
	else
	{
		var v = document.getElementById("variant").checked;
		var b = document.getElementById("copymode").checked;
		var j = b ? "SetClipBoard(\"$CHR$\");return false;" : ";";
		var h = "href='"+ref+"' target='_blank' title='U+$UCH$' onclick='"+j+"'";
		var u = document.getElementById("ucodeonly").checked;
		if (m == 0)  m = (s == lq) ? 999 : 99;
		l = GetMatch(s, v, d, u && !pua, m, h);
	}
	document.getElementById("counter").innerHTML = (l.length > m) ?
			("<span style='color:red'>超過 "+m+" 字</span>") : ("總計 "+l.length+" 字");
	document.getElementById("output").innerHTML = l.join(" ") + "<br>";
	registerDownloadImageEvent();
	lq = s;
};

// 清除檢索
var ClearFind=function()
{
	var e = document.getElementById("input");
	e.value = "";
	e.focus();
	FindMatch(0, false);
};

// 倒退清除
var Backspace=function()
{
	var e = document.getElementById("input");
	var n = GetPos(e);
	if (n > 0)
	{
		var s = e.value;
		var c = s.charCodeAt(n-2);
		var m = ((c >= 0xD800) && (c <= 0xDBFF)) ? n-2 : n-1;
		e.value = s.slice(0, m) + s.slice(n);
		SetPos(e, m);
		FindMatch(0, true);
	}
};

// 取代檢索
var ReplaceFind=function(s)
{
	var e = document.getElementById("input");
	if (!GetSel(e))  e.value = "";
	Key(s);
};

// 解構漢字
var Decompose=function()
{
	var e = document.getElementById("input");
	var n = GetPos(e);
	if (n > 0)
	{
		var s = e.value;
		var m = n - 1;
		var w = s.charAt(m);
		if (m > 0)
		{
			var c = s.charCodeAt(m-1);
			if ((c >= 0xD800) && (c <= 0xDBFF))
				w = s.charAt(--m) + w;
		}

		var d = document.getElementById("subdivide").checked;
		var t = Exhaust(w, d, 0);
		if (t.length)
		{
			e.value = s.slice(0, m) + t + s.slice(n);
			SetPos(e, m+t.length);
			FindMatch(0, true);
		}
	}
};

// 自訂鍵盤輸入
var Key=function(k)
{
	var e = document.getElementById("input");
	DelSel(e);
	var n = GetPos(e);
	var s = e.value;
	e.value = s.slice(0, n) + k + s.slice(n);
	var c = k.charCodeAt(0);
	var m = ((c >= 0xD800) && (c <= 0xDBFF)) ? n+2 : n+1;
	SetPos(e, m);
	FindMatch(0, true);
};

// 實體按鍵改變
var OnKey=function(k)
{
	switch (k)
	{
	case 0x0D:
		FindMatch(0, false);
		break;
	case 0x1B:
		ClearFind();
		break;
	}
};

// 包容異體改變
var OnVar=function()
{
	var b = document.getElementById("variant").checked;
	SetCookie("variant", b ? "1" : "0");
	document.getElementById("input").focus();
	FindMatch(0, true);
};

// 無理拆分改變
var OnSdv=function()
{
	var b = document.getElementById("subdivide").checked;
	SetCookie("subdivide", b ? "1" : "0");
	document.getElementById("input").focus();
	FindMatch(0, true);
};

// 限標準字改變
var OnUco=function()
{
	var b = document.getElementById("ucodeonly").checked;
	SetCookie("ucodeonly", b ? "1" : "0");
	document.getElementById("input").focus();
	FindMatch(0, false);
};

// 即時查詢改變
var OnFly=function()
{
	var b = document.getElementById("onthefly").checked;
	SetCookie("onthefly", b ? "1" : "0");
	document.getElementById("input").focus();
	FindMatch(0, true);
};

// 較大字形改變
var OnFnt=function()
{
	var b = document.getElementById("largefont").checked;
	SetCookie("largefont", b ? "1" : "0");
	document.getElementById("output").style.fontSize = b ? "2em" : "1.5em";
	renderLargeFont();
	document.getElementById("input").focus();
};

// 圖片模式改變
var OnGlyph=function()
{
	var b = document.getElementById("glyphmode").checked;
	SetCookie("glyphmode", b ? "1" : "0");
	renderGlyphMode();
	document.getElementById("input").focus();
};

// 複製模式改變
var OnCpy=function()
{
	var b = document.getElementById("copymode").checked;
	SetCookie("copymode", b ? "1" : "0");
	document.getElementById("input").focus();
	var e = document.getElementById("output").children;
	for (var i=0; i<e.length; i++)
	{
		if (b)
			e[i].onclick = function(){SetClipBoard(this.text);return false;};
		else
			e[i].onclick = function(){;};
	}
};

// 鍵盤開關改變
var isPadVisible = true;
var OnPad=function()
{
	isPadVisible = !isPadVisible;
	SetCookie("keypad", isPadVisible ? "1" : "0");
	document.getElementById("padbtn").innerHTML = isPadVisible ? "▲" : "▼";
	document.getElementById("keypad").style.display = isPadVisible ? "block" : "none";
	document.getElementById("input").focus();
};

// 初始化
var Init=function()
{
	document.getElementById("version").innerHTML = GetVersion();
	document.getElementById("variant").checked = GetCookie("variant", "1") == "1";
	document.getElementById("subdivide").checked = GetCookie("subdivide", "1") == "1";
	document.getElementById("ucodeonly").checked = GetCookie("ucodeonly", "1") == "1";
	document.getElementById("onthefly").checked = GetCookie("onthefly", "1") == "1";
	document.getElementById("largefont").checked = GetCookie("largefont", "1") == "1";
	document.getElementById("glyphmode").checked = GetCookie("glyphmode", "1") == "1";
	document.getElementById("copymode").checked = GetCookie("copymode", "0") == "1";
	document.getElementById("input").addEventListener('compositionstart', function(){ ime = true; });
	document.getElementById("input").addEventListener('compositionend', function(){ setTimeout(function(){ ime = false; FindMatch(0, true); }, 1); });

	OnFnt();
	OnGlyph();
	var s ="";
	for (var i=0; i<kt.length; i++)
	{
		s += "<th class='Cathdr'>";
		for (var j=0; j<kt[i].length; j++)
		{
			var w = kt[i].charAt(j);
			var c = w.charCodeAt(0);
			if ((c >= 0xD800) && (c <= 0xDBFF))  w += kt[i].charAt(++j);
			if (w == ":")
				break;
			else if (w == ",")
				s += "<br>";
			else
				s += w;
		}
		s += "</th>";
	}
	document.getElementById("cathdr").innerHTML = s;
	var s ="";
	for (var i=0; i<kt.length; i++)
	{
		s += "<td class='Catbdy'>";
		for (var j=kt[i].indexOf(":")+1; j<kt[i].length; j++)
		{
			var w = kt[i].charAt(j);
			var c = w.charCodeAt(0);
			if ((c >= 0xD800) && (c <= 0xDBFF))  w += kt[i].charAt(++j);
			if (w == ",")
				s += "<br>";
			else
				s += "<button class='Key' onclick='Key(\"" + w + "\")' oncontextmenu='SetClipBoard(\"" + w + "\");return false;'>" + w + "</button>";
		}
		s += "</td>";
	}
	document.getElementById("catbtn").innerHTML = s;
	isPadVisible = GetCookie("keypad", "1") == "0";
	OnPad();
};
window.onload = Init;
</script>

<!----------------------------------------------------------------------------->
<!-- 客製化修改區結束 -->
<!----------------------------------------------------------------------------->

<span style='display:block;text-align:right'><small>核心版本：<span id="version"></span></small></span>
<span style='display:block;text-align:right'><small>發布網址：<a href="http://fgwang.blogspot.tw/2015/12/blog-post_30.html">部件檢索</a> (WFG製作)</small></span>

<!----------------------------------------------------------------------------->
<!-- 核心程式區 -->
<script src="js/core.js?v=2"></script>
<!----------------------------------------------------------------------------->

</body></html>